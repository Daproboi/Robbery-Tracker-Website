<!DOCTYPE html>
<html>
<head>
    <title>My Robbery Tracker</title>
    <style>
        body { background-color: #0b0e14; color: white; font-family: sans-serif; padding: 20px; }
        
        /* FIXED: align-items: flex-start stops the buttons from being giant bars */
        .filter-bar { 
            display: flex; 
            gap: 8px; 
            margin-bottom: 30px; 
            flex-wrap: wrap; 
            align-items: flex-start; 
        }

        .filter-btn { 
            background: #1c1f26; border: 1px solid #30363d; color: white; 
            padding: 8px 14px; border-radius: 6px; cursor: pointer; 
            font-size: 13px; font-weight: 500; height: fit-content; transition: all 0.2s ease;
        }
        .filter-btn:hover { background: #30363d; border-color: #8b949e; }

        .container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        
        .card { background: #161b22; border-radius: 8px; padding: 20px; border: 1px solid #30363d; position: relative; }
        .card h3 { margin-top: 0; display: flex; justify-content: space-between; font-size: 18px; }
        
        .status { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .open { background: #238636; color: white; }
        .robbing { background: #d29922; color: black; }

        .join-btn { 
            width: 100%; background: #238636; color: white; border: none; 
            padding: 10px; border-radius: 5px; font-weight: bold; cursor: pointer; margin-top: 15px;
        }
        .join-btn:hover { background: #2ea043; }

        .copy-btn {
            width: 100%; background: #30363d; color: white; border: 1px solid #444c56; 
            padding: 8px; border-radius: 5px; font-size: 12px; cursor: pointer; margin-top: 8px;
        }
        .copy-btn:hover { background: #444c56; }
        
        .stats { color: #8b949e; font-size: 13px; margin-top: 12px; border-top: 1px solid #30363d; padding-top: 10px; }
    </style>
</head>
<body>

    <h1>ðŸš¨ Live Robbery Snipers</h1>

    <div class="filter-bar">
        <button class="filter-btn" onclick="currentFilter = 'all'; fetchRobberies();">All</button>
        <button class="filter-btn" onclick="currentFilter = 'Jewelry Store'; fetchRobberies();">Jewelry</button>
        <button class="filter-btn" onclick="currentFilter = 'Bank'; fetchRobberies();">Bank</button>
        <button class="filter-btn" onclick="currentFilter = 'Museum'; fetchRobberies();">Museum</button>
        <button class="filter-btn" onclick="currentFilter = 'PowerPlant'; fetchRobberies();">PowerPlant</button>
        <button class="filter-btn" onclick="currentFilter = 'Casino'; fetchRobberies();">Casino</button>
        <button class="filter-btn" onclick="currentFilter = 'Cargo Train'; fetchRobberies();">Cargo Train</button>
        <button class="filter-btn" onclick="currentFilter = 'Tomb'; fetchRobberies();">Tomb</button>
        <button class="filter-btn" onclick="currentFilter = 'Mansion'; fetchRobberies();">Mansion</button>
        <button class="filter-btn" onclick="currentFilter = 'Airdrop'; fetchRobberies();">Airdrops</button>
    </div> 
    
    <div class="container" id="card-container">
        <p style="color:gray;">Waiting for bot data...</p>
    </div>

    <script>
        const FIREBASE_URL = "https://robbery-tracker-d43c5-default-rtdb.firebaseio.com/robberies.json";
        let currentFilter = 'all';

        async function fetchRobberies() {
            try {
                const response = await fetch(FIREBASE_URL);
                const data = await response.json();
                if (data) {
                    let robberyArray = Object.values(data);
                    if (currentFilter !== 'all') {
                        robberyArray = robberyArray.filter(r => r.name.includes(currentFilter));
                    }
                    displayCards(robberyArray);
                }
            } catch (error) { console.error(error); }
        }

        function displayCards(data) {
            const container = document.getElementById('card-container');
            container.innerHTML = ""; 
            const currentTime = Math.floor(Date.now() / 1000);

            data.forEach(rob => {
                const timePassed = currentTime - rob.lastUpdated;
                if (timePassed < 300) {
                    const statusClass = rob.status === "Open" ? "open" : "robbing";
                    container.innerHTML += `
                        <div class="card">
                            <h3>${rob.name} <span class="status ${statusClass}">${rob.status}</span></h3>
                            <button class="join-btn" onclick="joinServer('${rob.jobId}')">JOIN SERVER</button>
                            <button class="copy-btn" onclick="copyId('${rob.jobId}', this)">COPY JOB ID</button>
                            <div class="stats">
                                <span>ðŸ‘¥ Players: ${rob.players}</span>
                            </div>
                        </div>
                    `;
                }
            });
        }

        function joinServer(jobId) {
            // Using the "Secret" PlaceID from your Muffin Hook discovery
            const jailbreakPlaceId = 606849621;
            const secretUrl = `roblox://experiences/start?placeId=${jailbreakPlaceId}&gameInstanceId=${jobId}`;
            
            // Triggering the join via a hidden window to bypass browser security
            const launchWindow = window.open(secretUrl, '_blank');
            
            // Auto-close the blank window after launch
            setTimeout(() => {
                if (launchWindow) launchWindow.close();
            }, 500);
        }

        function copyId(id, btn) {
            navigator.clipboard.writeText(id).then(() => {
                const oldText = btn.innerText;
                btn.innerText = "âœ… COPIED!";
                setTimeout(() => btn.innerText = oldText, 2000);
            });
        }

        setInterval(fetchRobberies, 5000);
        fetchRobberies();
    </script>
</body>
</html>

